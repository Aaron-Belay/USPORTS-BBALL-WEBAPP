{% extends "base.html" %} {% block content %}

<body>
  <h1 class="text-center text-gray-400 font-bold text-xl md:text-3xl py-2">
    {{ league }} League
  </h1>
  <!-- Navigation -->
  <div class="flex justify-center">
    <nav class="flex flex-row" role="group">
      <button id="standingsBtn" type="button" class="nav-btn">
        Standings
      </button>
      <button id="leaderboardBtn" type="button" class="nav-btn">
        <span class="hidden md:inline">Stats Leaderboard</span>
              <!-- Hidden on small screens -->
              <span class="md:hidden">Stats</span>
      </button>
      <button id="teamAnalyticsBtn" type="button" class="nav-btn">
        <span class="hidden md:inline">Team Analytics</span>
              <!-- Hidden on small screens -->
              <span class="md:hidden">Analytics</span>
      </button>
      </button>
      <button id="playoffsBtn" type="button" class="nav-btn">
        Playoffs
      </button>
    </nav>
  </div>

  <!-- Standings Section -->
  <div id="standings-section" style="display: block">
    <h2 class="text-base md:text-xl font-bold  mt-8 text-center text-gray-500">STANDINGS</h2>
    <div id="filters" class="text-left my-4 pl-5 text-xs ">
      <label for="conference-filter" class="text-white font-bold mr-2">Filter by Conference:</label>
      <select id="conference-filter"
        class="py-2 px-4 rounded bg-gray-800 text-white hover:bg-gray-700 focus:bg-gray-700">
        <option value="all" class="text-white">All Conferences</option>
        <option value="OUA" class="text-white">OUA</option>
        <option value="AUS" class="text-white">AUS</option>
        <option value="CW" class="text-white">CW</option>
        <option value="RSEQ" class="text-white">RSEQ</option>
      </select>
    </div>

    <div style="margin: 0 auto" class="team-container w-full lg:w-5/6 xl:w-2/3">

      <table class="w-full  border-collapse ">
        <thead class="border border-gray-800">
          <tr class="text-xs md:text-base">
            <th class="py-2 border-r border-gray-800">#</th>
            <th class="border-r border-gray-800 ">TEAM </th>
            <th class=" border-r border-gray-800">
              <span class="hidden md:inline">WIN</span>
              <!-- Hidden on small screens -->
              <span class="md:hidden">W</span>
              <!-- Shown on small screens -->
            </th>
            <th class="border-r border-gray-800">
              <span class="hidden md:inline">LOSS</span>
              <!-- Hidden on small screens -->
              <span class="md:hidden">L</span>
              <!-- Shown on small screens -->
            </th>
            <th class="border-r border-gray-800">PCT</th>
            <th class="border-r border-gray-800">GP</th>
            <th class="border-r border-gray-800">
              <span class="hidden md:inline">LAST 10</span>
              <!-- Hidden on small screens -->
              <span class="md:hidden">L 10</span>
              <!-- Shown on small screens -->
            </th>
            <th class="border-b border-r border-gray-800">
              <span class="hidden md:inline">STREAK</span>
              <!-- Hidden on small screens -->
              <span class="md:hidden">STK</span>
              <!-- Shown on small screens -->
            </th>
          </tr>
        </thead>


        <tbody class=" bg-slate-950 rounded-lg shadow-md ">
          {% for team in teams %}

          <tr class=" team {{ team.conference }} text-xs md:text-base  border-gray-800 text-center even:bg-slate-900">
            <td class="border-r border-gray-800">{{ loop.index }}</td>
            <td class="border-r border-gray-800 flex items-center">
              <img src="{{ url_for('static', filename='team_logos/' + team.team_name +'.png') }}" alt="Team Logo"
                class="max-w-8 max-h-8 md:max-w-14 md-max-h-14 mx-3" />
              <span class="font-bold">
                {% if team.team_name == 'Toronto Metropolitan' %}
                <a href="{{ url_for('team_page', league_path=league_path, team_path='Toronto Metropolitan') }}"
                  class="no-underline hover:underline">TMU</a>
                {% else %}
                <a href="{{ url_for('team_page', league_path=league_path, team_path=team.team_name) }}"
                  class="no-underline hover:underline">{{ team.team_name }}</a>
                {% endif %}
              </span>
            </td>

            <td class=" p-1 border-r border-gray-800">{{ team.total_wins }}</td>
            <td class="p-1 border-r border-gray-800">{{ team.total_losses }}</td>
            <td class="p-1 font-bold  border-r border-gray-800"> {{ team.win_percentage }}</td>
            <td class="p-1 border-r border-gray-800">{{ team.games_played }}</td>
            <td class="border-r border-gray-800">{{ team.last_ten_games }}</td>
            <td class="border-r border-gray-800">{{ team.streak }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>

  <!-- Player Leaderboard Section -->
  <div id="playerleaderboard-section" style="display: none" class="flex flex-col">
    {% set numval = 10 %}

    <h2 class="text-base md:text-xl font-bold  mt-8 text-center text-gray-500">LEADERBOARD</h2>

    <!-- Points per game -->
    <div >
      <h2 class="leaderboard-stats-subtitle">Points per game</h2>
      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='points_per_game', reverse=true)) %} {% if
        player.games_played > (0.6 * player.team_games_played) %}{%if
        count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.points_per_game }} &nbsp;&nbsp;
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

    <!-- Rebounds per game -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Rebounds per game</h2>
      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='rebounds_per_game', reverse=true)) %} {% if
        player.games_played > (0.6 * player.team_games_played) %}{%if
        count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.rebounds_per_game }}&nbsp;&nbsp;
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

    <!-- Assists per game -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Assists per game</h2>
      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='assists_per_game', reverse=true)) %} {% if
        player.games_played > (0.6 * player.team_games_played) %}{%if
        count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.assists_per_game }} &nbsp;&nbsp;
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

    <!-- Field Goal Percentage -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Field Goal Percentage</h2>

      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='field_goal_percentage', reverse=true)) %} {% if
        (player.games_played > (0.6 * player.team_games_played)) and
        (player.field_goal_made_per_game > 3) %}{%if count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.field_goal_percentage}}%
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

      <!-- 3-pointers made per game -->
    <div>
      <h2 class="leaderboard-stats-subtitle">
        Three pointers made per game
      </h2>

      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='three_pointers_made_per_game', reverse=true))
        %} {% if player.games_played > (0.6 * player.team_games_played) %}{%if
        count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.three_pointers_made_per_game }} &nbsp;&nbsp;
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

      <!-- 3-point percentage -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Three Point Percentage</h2>

      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='three_pointers_percentage', reverse=true)) %}
        {% if (player.games_played > (0.6 * player.team_games_played)) and
        (player.three_pointers_made_per_game > 1) %}{%if count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.three_pointers_percentage }}%
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

    <!-- Blocks per game -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Blocks per Game</h2>

      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='blocks_per_game', reverse=true)) %} {% if
        player.games_played > (0.6 * player.team_games_played) %}{%if
        count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.blocks_per_game }} &nbsp;&nbsp;
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

    <!-- Steals per game -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Steals Per Game</h2>

      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='steals_per_game', reverse=true)) %} {% if
        player.games_played > (0.6 * player.team_games_played) %}{%if
        count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.steals_per_game }} &nbsp;&nbsp;
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

      <!-- Free throws made per game -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Free Throws Made Per Game</h2>

      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='free_throws_made_per_game', reverse=true)) %}
        {% if player.games_played > (0.6 * player.team_games_played) %}{%if
        count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.free_throws_made_per_game }} &nbsp;&nbsp;
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

    <!-- free throws percentage -->
    <div>
      <h2 class="leaderboard-stats-subtitle">Free Throws Percentage</h2>

      <table class="leaderboard-stats-table">
        {% set count = namespace(value=numval) %} {% for player in
        (players|sort(attribute='free_throws_percentage', reverse=true)) %} {%
        if (player.games_played > (0.6 * player.team_games_played)) and
        (player.free_throws_made_per_game > 2) %}{%if count.value >= 1%}

        <tr class="pb-4 even:bg-slate-900">
          <td class="py-1 w-1/12 pl-3">{{ numval - count.value + 1}}</td>
          <td class="py-1 font-bold text-left">
            {{ player.lastname_initials }} &nbsp {{ player.first_name }}
          </td>
          <td class="py-1 w-1/12">
            <img src="{{ url_for('static', filename='team_logos/' + player.school +'.png') }}" alt="Team Logo"
              class="max-w-8 max-h-8" />
          </td>
          <td class="py-1 text-sm">{{ player.school }}</td>
          <td class="py-1 font-bold text-center">
            {{ player.free_throws_percentage }}%
          </td>
        </tr>
        {% set count.value = count.value - 1 %} {% endif %} {% endif %} {%
        endfor %}
      </table>
    </div>

  </div>

  <!-- Team Analytics Section -->
  <div id="teamanalytics-section" style="display: none">
    <div class="max-w-xl mx-auto mt-8">
      <p class="text-center text-xs md:text-sm text-gray-500">
        Select two teams from the dropdown menu to compare their stats plotted
        in the radar chart.
      </p>
    </div>
    <!-- Team Selection Dropdowns -->
    <div class="my-5 flex justify-center space-x-4 text-xs md:text-lg">
      <select id="team1-select"
        class="text-center rounded bg-gray-800 text-white hover:bg-gray-700 focus:bg-gray-700 w-1/4">
        <!-- Populate options dynamically using Flask -->
        {% for team in (teams |sort(attribute='team_name' )) %}
        <option value="{{ team.team_name }}">{{ team.team_name }}</option>
        {% endfor %}
      </select>

      <select id="team2-select"
        class="text-center rounded bg-gray-800 text-white hover:bg-gray-700 focus:bg-gray-700 w-1/4">
        <!-- Populate options dynamically using Flask -->
        {% for team in (teams |sort(attribute='team_name' )) %}
        <option value="{{ team.team_name }}">{{ team.team_name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="flex justify-center items-center">
      <canvas id="radarChart" width="400" height="400"></canvas>
    </div>

    <script>
      // Radar data from Flask app
      const radarData = {{ radar_data| tojson | safe }};
    </script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
  </div>

  <!-- Playoffs Section -->
  <div id="playoffs-section" style="display: none">
    <div class="max-h-screen my-10 flex flex-col justify-center items-center">
      <img src="https://www.svgrepo.com/show/426192/cogs-settings.svg" alt="Logo" class="mb-8 h-40" />
      <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-center text-gray-700 dark:text-white mb-4">
        This page is under maintenance
      </h1>
      <div class="flex space-x-4 my-10">
        <a href="/#bottom"
          class="bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded dark:bg-gray-700 dark:hover:bg-gray-600">Contact
          Me</a>
        <a href="#" onclick="window.location.reload(true);"
          class="border-2 border-gray-800 text-black font-bold py-3 px-6 rounded dark:text-white dark:border-white">Standings</a>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
{% endblock %}